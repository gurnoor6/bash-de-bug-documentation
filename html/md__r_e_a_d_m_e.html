<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bash-de-bug: Bash-De-Bug</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bash-de-bug
   &#160;<span id="projectnumber">version 1.0.0</span>
   </div>
   <div id="projectbrief">Debugging Bash script</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Bash-De-Bug </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Course Project of CS251, Autumn 2020.</p>
<p>The aim of this project is to build a debugger, primarily intended for Bash Scripts, that prints out the variables and the contents of files that are being used in the program. Although the way this is being built, it wont be hard to extend it to other languages as well.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Approach</h1>
<p>The project is overall divided into two parts - one is the front-end part where we build a Tkinter based GUI for the project, and another is the backend part, where we manage writing a parser for Bash scripts, detecting variable assignments in it, and inserting the print statements in a copy of the script. Then we execute the script from within python, and redirect the output to the user, filtering the line numbers / variable names requested.</p>
<p>Initially, we planned to just do a string search for the file, detect <code>=</code> signs for assignment operations, check for a few more conditions and conclude that the variable is detected. But this approach did not seem elegant or challenging, it seemed just like a workaround. So we decided to go with parsing.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
GUI</h2>
<ul>
<li>The front-end of the project has been designed with the help of <code>tkinter</code> module in python.</li>
<li>The Main window is divided into three sections:<ul>
<li>Bash IDE region</li>
<li>Debugger region</li>
<li>Variables list region</li>
</ul>
</li>
<li>The Bash IDE is an attempt to take as input the code provided by the user, as well as function as an independent code editor. The following features have been added to imitate any generic IDE:<ul>
<li>Editing shortcuts like cut (Control-c) and paste (Control-v)</li>
<li>Find and Replace option for easy editing</li>
<li>Line number class to implement dynamic line numbering and scroll features</li>
<li>Syntax highlighting of Bash keywords, numbers and strings for a smoother coding experience</li>
</ul>
</li>
</ul>
<p>This is an example of how the IDE region should look (in Dark Mode!!)</p>
<p><img src="screenshots/gui-dark.png" alt="" height="500" class="inline"/><br  />
 </p>
<h2><a class="anchor" id="autotoc_md3"></a>
Parsing</h2>
<ul>
<li>The first thing we looked for parsing was a library named <a href="https://github.com/idank/bashlex">bashlex</a>. But this had a lot of issues and did not turn out well.</li>
<li>So we resorted to making a custom parser and lexer using <a href="https://github.com/antlr/antlr4">ANTLR4</a>.</li>
<li>The first step was to create a grammar file, which contained the parser and lexer rules.</li>
<li>The lexer tokenises the whole input file. The rules for tokens are defined uisng regular expressions, in the grammar file. Also, extreme care had to be taken in the order of tokens, the ones defined first are given higher preference. Moreover, the lexer tries to generate the least number of tokens possible.</li>
<li>The parser rules use the tokens generated above, to recognise the various structures such as for/while loops, if/else statements and assignment operations.</li>
<li>After writing rules in grammar, we generate the parser in Python. It basically gives us a tree structure of the whole program, by doing a depth first search in it. There are various entry and exit functions available, which we use to gain relevant information.</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
What It CAN do</h1>
<ul>
<li>We type a bash script, or choose a file from our PC and the program detects all the variables in the script and displays them on the GUI.</li>
<li>The user is asked to select the variables, and/or the line numbers between which he wants to view the variables.</li>
<li>The required output is shown on the output box, and we have a substring matching feature through which the user can even search for the required variable and line number.</li>
<li>It can go through for/while loops, and assignment operations. It can also handle basic bash commands like <code>wget</code>, <code>ls</code>, <code>cat</code>, <code>cut</code>, etc.</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
What it CANNOT do</h1>
<ul>
<li>It cannot check for the correctness of the syntax. The bash syntax is quite diverse and writing a rule for each of them with proper arguments and flags would get quite difficult.</li>
<li>It assumes that the syntax is correct, and hence helps to fix the <b>logical errors</b>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
Phase 2 plans</h1>
<ul>
<li>Most of the time in phase 1 was spent in deciding the approach to be used, and we finally settled on ANTLR :)</li>
<li>The basic framework for the GUI is ready, but some extra features and overall polishing is yet to be done.</li>
<li>The basic parsing is done. We are able to parse <b>for/while loops, assignment operations, linux commands, nested loops, nested if-else statements</b> but still we have to work with <b>sed</b> scripts and <b>function calls</b>. Although we are hopeful that we'll be able to do them using ANTLR as well, but just in case any problems arise, we might resort to string search, but that is worst case scenario.</li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
Example</h1>
<p>For the following input, </p><pre class="fragment">#!bin/bash

a=2;
b=100;

for ((;a&lt;b;a+=23));
do
    echo "looping continues"
done

if ((a&gt;110)); then
    echo $(pwd)
else
    echo "Better luck next time"
fi
</pre><p> the abstract syntax tree that we get is <br  />
 <img src="testcases/test4.png" alt="" height="300" width="1000" class="inline"/> <br  />
 and the corresponding tokens generated are <br  />
 </p><pre class="fragment">[@0,10:10='\r',&lt;SPACE&gt;,1:10]
[@1,11:11='\n',&lt;SPACE&gt;,1:11]
[@2,12:12='\r',&lt;SPACE&gt;,2:0]
[@3,13:13='\n',&lt;SPACE&gt;,2:1]
[@4,14:14='a',&lt;VAR&gt;,3:0]
[@5,15:15='=',&lt;'='&gt;,3:1]
[@6,16:16='2',&lt;VAL&gt;,3:2]
[@7,17:17=';',&lt;';'&gt;,3:3]
[@8,18:18='\r',&lt;SPACE&gt;,3:4]
[@9,19:19='\n',&lt;SPACE&gt;,3:5]
[@10,20:20='b',&lt;VAR&gt;,4:0]
[@11,21:21='=',&lt;'='&gt;,4:1]
[@12,22:24='100',&lt;VAL&gt;,4:2]
[@13,25:25=';',&lt;';'&gt;,4:5]
[@14,26:26='\r',&lt;SPACE&gt;,4:6]
[@15,27:27='\n',&lt;SPACE&gt;,4:7]
[@16,28:28='\r',&lt;SPACE&gt;,5:0]
[@17,29:29='\n',&lt;SPACE&gt;,5:1]
[@18,30:32='for',&lt;'for'&gt;,6:0]
[@19,33:33=' ',&lt;SPACE&gt;,6:3]
[@20,34:35='((',&lt;OPEN_BRACKETS&gt;,6:4]
[@21,36:36=';',&lt;';'&gt;,6:6]
[@22,37:37='a',&lt;VAR&gt;,6:7]
[@23,38:38='&lt;',&lt;COMPARE&gt;,6:8]
[@24,39:39='b',&lt;VAR&gt;,6:9]
[@25,40:40=';',&lt;';'&gt;,6:10]
[@26,41:41='a',&lt;VAR&gt;,6:11]
[@27,42:43='+=',&lt;INCREMENT&gt;,6:12]
[@28,44:45='23',&lt;VAL&gt;,6:14]
[@29,46:47='))',&lt;CLOSE_BRACKETS&gt;,6:16]
[@30,48:48=';',&lt;';'&gt;,6:18]
</pre><p>The GUI generated using Tkinter, giving an idea of what we hope to accomplish<br  />
 <img src="screenshots/gui.png" alt="" height="500" width="1000" class="inline"/><br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0 </li>
  </ul>
</div>
</body>
</html>
